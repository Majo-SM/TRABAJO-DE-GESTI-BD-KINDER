---	Cursor que muestre la cantidad de niños y niñas inscritas en cada año lectivo del ciclo.
--CURSOR MUESTRA TODOS LOS NIÑOS JUNTOS
DO $$
DECLARE
	
	C_MATRICULADOS CURSOR FOR SELECT AN_INICIO_L, COUNT(IDMATRICULA) AS NINOS FROM MATRICULACION MAT 
	INNER JOIN ANO_LECT LEC ON LEC.ID_AN_LECTIVO = MAT.ID_AN_LECTIVO 
	GROUP BY LEC.ID_AN_LECTIVO;
	
BEGIN
	FOR NINO IN C_MATRICULADOS
	LOOP
	RAISE NOTICE 'AÑO LECTIVO: %	NIÑOS/AS: %', NINO.AN_INICIO_L, NINO.NINOS;
	END LOOP;
END; 
$$ LANGUAGE 'plpgsql';

DO $$
DECLARE
	MASC INT := 0;
	FEM INT := 0;
	C_MATRICULADOS CURSOR FOR SELECT * FROM MATRICULACION MAT 
	INNER JOIN REG_NINO NINO ON NINO.ID_ALUMNO = MAT.ID_ALUMNO 
	INNER JOIN ANO_LECT LEC ON LEC.ID_AN_LECTIVO = MAT.ID_AN_LECTIVO;
	
	C_AN_LECTIVO CURSOR FOR SELECT * FROM ANO_LECT;
	
--CURSOR MUESTRA NIÑOS Y NIÑAS
BEGIN
 FOR ANO IN C_AN_LECTIVO
 LOOP
 	MASC = 0;
	FEM = 0;
	FOR NINO IN C_MATRICULADOS
	LOOP
	MASC = MASC + COUNT(NINO.IDMATRICULA) WHERE NINO.GENERO_NI LIKE 'mas%' AND ANO.AN_INICIO_L = NINO.AN_INICIO_L;
	FEM = FEM + COUNT(NINO.IDMATRICULA) WHERE NINO.GENERO_NI LIKE 'fem%' AND ANO.AN_INICIO_L = NINO.AN_INICIO_L;
	END LOOP;
	RAISE NOTICE 'AÑO LECTIVO: %	NIÑOS:% 	NIÑAS: %', ANO.AN_INICIO_L, MASC, FEM;
 END LOOP;
END; 
$$ LANGUAGE 'plpgsql';
